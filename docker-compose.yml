version: "3"
services:
  swag:
    image: ghcr.io/linuxserver/swag
    container_name: swag
    cap_add:
      - NET_ADMIN
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
      - URL=cromedev.duckdns.org
      - SUBDOMAINS=www,
      - VALIDATION=duckdns
      - DUCKDNSTOKEN=40ec2401-1546-484c-a2cd-26691ecc0ebb
      - EMAIL=piergiuseppe.mallozzi@gmail.com
    volumes:
      - ./frontend/build:/config/www
      - ./frontend/config_nginx:/config/nginx/
    ports:
      - 443:443
      - 80:80
    restart: unless-stopped

  backend:
    image: pmallozzi/crome-web:dev
    restart: always
    container_name: backend
    volumes:
      - ./src/frontend/build:/home/crome-web/src/frontend/build
      - ../cert.pem:/home/crome-web/src/cert.pem
      - ../privkey.pem:/home/crome-web/src/privkey.pem
    expose:
      - 5000
    ports:
      - 5000:5000
    command: -b